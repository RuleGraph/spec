{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://rulegraph.org/schema/lawcard/v0.2.1/extensions/signatures.schema.json",
  "title": "LawCard Extension â€” signatures",
  "type": "array",
  "items": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "alg": { "type": "string", "minLength": 2 },
      "keyId": { "type": "string", "format": "uri-reference" },
      "scope": {
        "oneOf": [
          { "type": "string", "enum": ["card"] },
          {
            "type": "array",
            "minItems": 1,
            "items": { "type": "string", "minLength": 1 }
          }
        ],
        "default": "card",
        "description": "What was signed: 'card' (entire card sans sha/signatures) or an array of equation ids (e.g. '#eq/1')."
      },
      "hashProfile": {
        "type": "string",
        "default": "sha256-json-canon-v1",
        "description": "Digest recipe (e.g., sorted-keys/compact, excluding sha256 & signatures)."
      },
      "signedAt": { "type": "string", "format": "date-time" },
      "sig": {
        "type": "string",
        "pattern": "^[A-Za-z0-9_-]+$",
        "description": "Base64url-encoded signature bytes."
      }
    },
    "required": ["alg", "keyId", "sig"]
  }
}

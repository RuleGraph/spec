{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://rulegraph.org/schema/lawcard/v0.2/extensions/test-vectors.schema.json",
  "title": "LawCard Extension: Test Vectors",
  "type": "array",
  "minItems": 1,
  "items": {
    "type": "object",
    "additionalProperties": false,
    "required": ["inputs", "expected"],
    "properties": {
      "name": {
        "description": "Short label for this test case.",
        "type": "string"
      },
      "description": {
        "description": "Optional explanation or scenario notes.",
        "type": "string"
      },
      "inputs": {
        "description": "Symbol → value map used to evaluate the law.",
        "type": "object",
        "minProperties": 1,
        "additionalProperties": {
          "description": "Scalar or vector numeric literal.",
          "oneOf": [
            { "type": "number" },
            {
              "type": "array",
              "minItems": 2,
              "maxItems": 16,
              "items": { "type": "number" }
            }
          ]
        }
      },
      "expected": {
        "description": "Symbol → Quantity of expected outputs; plus a 'tolerance' block.",
        "type": "object",
        "minProperties": 1,
        "properties": {
          "tolerance": {
            "description": "Relative/absolute comparison tolerances for this test case.",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "rel": {
                "description": "Relative tolerance (fractional).",
                "type": "number",
                "exclusiveMinimum": 0
              },
              "abs": {
                "description": "Absolute tolerance (same units as the compared quantity).",
                "type": "number",
                "exclusiveMinimum": 0
              }
            }
          }
        },
        "patternProperties": {
          "^(?!tolerance$)[A-Za-z_][A-Za-z0-9_]*$": {
            "$ref": "#/$defs/Quantity"
          }
        },
        "additionalProperties": false
      }
    }
  },
  "$defs": {
    "Quantity": {
      "description": "A numeric scalar or vector with units.",
      "type": "object",
      "required": ["value", "unit"],
      "additionalProperties": false,
      "properties": {
        "value": {
          "oneOf": [
            { "type": "number" },
            {
              "type": "array",
              "minItems": 2,
              "maxItems": 16,
              "items": { "type": "number" }
            }
          ]
        },
        "unit": {
          "description": "QUDT unit IRI/curie (e.g., 'unit:N', 'unit:M-PER-SEC').",
          "type": "string",
          "minLength": 1
        }
      }
    }
  }
}
